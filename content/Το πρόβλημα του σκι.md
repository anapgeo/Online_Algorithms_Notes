## Το πρόβλημα

- Είμαστε σε διακόπες σε ένα χιονοδρομικό και θέλουμε να μάθουμε σκι
- Η ενοικίαση εξπλισμού σκι κοστίζει 20 ευρώ/ημέρα
- Η αγορά του εξοπλισμού κοστίζει 200 ευρώ
- Δεν γνωρίζουμε για πόσες μέρες θα μας αφήσουν να μείνουμε στο χιονοδρομικό
- Η είσοδος μας είναι τα αιτήματα $\large σ=(σ_1,...,σ_t,...)$
- Έστω $\large σ_i$ το αίτημα της μέρας $i$
	- Αν $\large σ_i=Μ$ παραμένουμε στο χιονοδρομικό
	- Αν $\large σ_i=Δ$ αποχωρούμε από το χιονοδρομικό
- Ως $\large I_j$ συμβολίζουμε την ακολουθία εκείνη σύμφωνα με την οποία θα παραμείνουμε στο χιονοδρομικό για j ημέρες. Πχ $\large I_3=(Μ,Μ,Μ,Δ)$
- Ο στόχος μας είναι να πληρώσουμε όσο το δυνατον λιγότερα χρήματα σε σύγκριση με το βέλτιστο που θα μπορούσαμε να πράξουμε αν ξέραμε τι θα συνέβαινε
- Όπου βέλτιστο εννούμε $\large OPT(I_j)= \min\{ 200,20j\}$
- Έστω $\large ALG_i$ ο αλγόριθμος που νοικιάζει μέχρι και τη μέρα $\large i-1$ και στη συνέχεια αγοράζει τον εξοπλισμό την ημέρα $\large i$



## Competitive Analysis

Για τον αλγόριθμο $\large ALG$ που θα επιλέξουμε έχουμε $\large ALG(σ)$ να είναι το ποσό που θα πληρώσουμε.  Επίσης $\large OPT(σ)$ είναι το κόστος της βέλτιστης λύσης αν γνωρίζαμε την ακολουθία $\large σ$, όπου θα ήταν μια ακολουθία $\large I_j$. Φυσικά $\large OPT(I_j)= \min\{ 200,20j\}$. 

Άρα αφού τα $\large ALG(σ)$ και $\large OPT(σ)$ εκφράζουν κόστοι, το competitive ratio μας θα είναι $$\large \max_σ\frac{ALG(σ)}{OPT(σ)}$$

Παράδειγμα: Έστω ότι επιλέγουμε τον αλγόριθμo $\large ALG_2$ σύμφωνα με τον οποίο ενοικιάζουμε την πρώτη μέρα και αγοράζουμε τη επόμενη. Τότε έστω ακολουθία $\large σ=(Μ,Μ,Μ,Δ)=Ι_3$.
$$ALG_2(\sigma)= 20 + 200=220$$
ενώ
$$OPT(\sigma)= 20 +20+20=60$$

Άρα $$\frac{ALG_2(σ)}{OPT(σ)}=220/60=22/6$$
## Ο βέλτιστος αλγόριθμος 



Ο βέλτιστος αλγόριθμος για το πρόβλημα μας είναι ο $\large ALG_{10}$, ο οποίος έχει λόγο ανταγωνισμού το πολύ 2.

### Απόδειξη:

Θεωρούμε 2 πιθανές περιπτώσεις για την είσοδο $\large I_j$

**Περίπτωση 1 ($\large j < 10$)**: 
- $\large ALG_{10}(I_j)=20j$
- $\large OPT(I_j)=min(20j,200)=20j$
- $\large r=1$
  
**Περίπτωση 2 ($\large j \geq 10$)**: 
- $\large ALG_{10}(I_j)=9 \cdot 20 +200=380$
- $\large OPT(I_j)=min(20j,200)=200$
- $\large r=380/200 \leq 2$

### Γενίκευση της απόδειξης

- Έστω κόστος ενοικίασης 1 ευρώ/μέρα
- Και κόστος αγοράς Β ευρω, όπου Β ακέραιος >1

Ο βέλτιστος αλγόριθμος είναι ο $\large ALG_B$ και έχει competitive ratio το πολύ $\large 2-\frac{1}{B}$

**Απόδειξη** :

**Περίπτωση 1 ($\large j < Β$)**: 
- $\large ALG_{Β}(I_j)=OPT(I_j)=j$
- $\large r=1$
  
**Περίπτωση 2 ($\large j \geq 10$)**: 
- $\large ALG_{Β}(I_j)=(Β-1) +Β= 2Β -1$
- $\large OPT(I_j)=Β$
- $\large r=\max_j r(I_j)=2-\frac{1}{B}$


## Κάτω Φράγμα

Μπορούμε να αποδείξουμε πως δεν υπάρχει κανένας ντετερμινιστικός άμεσος αλγόριθμος ο οποίος να πετυχαίνει λόγο ανταγωνισμού μικρότερο από $\large 2-\frac{1}{B}$;


### Λήμμα 

Δεν υπάρχει ντετερµινιστικός αλγόριθµος µε λόγο ανταγωνισµού καλύτερο από $\large 2-\frac{1}{B}$

--- 
**Απόδειξη**:

- Εστω ότι επιλέγουμε ένα ντετερμινιστικό αλγόριθμο $\large ALG_i$ 
- Ο αντίπαλος μας για να επιτύχει το μεγαλύτερο δυαντό competitive ratio επιλέγει πάντα να τερματίσει τη διαμονή μας στο χιονοδρομικό τη μέρα που αγοράσαμε τον εξοπλισμό άρα θα μας δίνει ως είσοδο την ακολουθία $\large Ι_i$. 

**Περίπτωση 1 ($\large i < Β$)**: 
- $\large ALG_{i}(I_i)= (i-1) + B$
- $\large OPT(I_i)= i$
- $\large r=\frac{(i-1)+B}{i}=1 +\frac{B-1}{i}\geq 1 +\frac{B-1}{B}= 2- \frac{1}{B}$
  
**Περίπτωση 2 ($\large i \geq B$)**: 
- $\large ALG_{i}(I_i)=(i-1) +Β$
- $\large OPT(I_j)=Β$
- $\large r=\frac{i-1+B}{B} \geq \frac{2B-1}{B}= 2-\frac{1}{B}$ άρα πετυχαίνουμε το κάτω φράγμα $2-\frac{1}{B}$ για $i=B$
---


## Τυχαιοποιημένος Αλγόριθμος

Μπορούμε να βελτιώσουμε το competitive ratio χρησμιμοποιώντας τυχαιοποίηση στον αλγόριθμο μας;

Ένας τυχαιοποιημένος αλγόριθμος είναι μια πιθανοτική κατανομή πάνω σε ντετερμινιστικούς αλγορίθμους. 
- πχ με πιθανότητα 1/3 επιλέγουμε τον $ALG_1$ και με 2/3 τον $ALG_3$

Στη συνέχεια υπολογίζουμε το αναμενόμενο κόστος $\mathbb{E}[ALG(\sigma)]$ του τυχαιοποιημένου αλγορίθμου για μια ακολουθία $\sigma$ 

To competitive ratio είναι ο μεγαλύτερος(χειρότερος) λόγος $\large \frac{\mathbb{E}[ALG(σ)]}{OPT(σ)}$  δεδομένων των δυνατών ακολουθιών $\large \sigma$: $$\large \max_\sigma\frac{\mathbb{E}[ALG(σ)]}{OPT(σ)}$$
### Warm Up

Σε μια πρώτη προσπάθει δημιουργίας ενός τυχαιοποιημενου αλγορίθμου επιλέγουμε
- με πιθανότητα p το αλγόριθμο $ALG_{B/2}$
- με πιθανότητα 1-p τον αλγόριθμο $ALG_{B}$

Στη συνέχεια ο αντίπαλος μας θα πρέπει να επιλέξει τη χειρότερη δυνατή είσοδο:

Οι πιθανές χειρότερες είσοδοι είναι $I_{B/2}$ και $I_{B}$

Για είσοδο $I_B$:

- $\mathbb{E}$